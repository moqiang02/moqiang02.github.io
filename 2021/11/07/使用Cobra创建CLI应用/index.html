<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>使用Cobra创建CLI应用 | 自强不息</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="虽然现在我们使用的大多数软件都是可视化的，很容易上手，但是这并不代表 CLI（命令行）应用就没有用武之地了，特别是对于开发人员来说，还是会经常和 CLI 应用打交道。而 Golang 就非常适合用来构建 CLI 应用，下面我们就将来介绍如何在 Golang 中构建一个 CLI 应用。 对于开发人员来说平时可能就需要使用到很多 CLI 工具，比如 npm、node、go、python、docker、">
<meta property="og:type" content="article">
<meta property="og:title" content="使用Cobra创建CLI应用">
<meta property="og:url" content="http://moqiang02.github.io/2021/11/07/%E4%BD%BF%E7%94%A8Cobra%E5%88%9B%E5%BB%BACLI%E5%BA%94%E7%94%A8/index.html">
<meta property="og:site_name" content="自强不息">
<meta property="og:description" content="虽然现在我们使用的大多数软件都是可视化的，很容易上手，但是这并不代表 CLI（命令行）应用就没有用武之地了，特别是对于开发人员来说，还是会经常和 CLI 应用打交道。而 Golang 就非常适合用来构建 CLI 应用，下面我们就将来介绍如何在 Golang 中构建一个 CLI 应用。 对于开发人员来说平时可能就需要使用到很多 CLI 工具，比如 npm、node、go、python、docker、">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-11-07T12:34:56.000Z">
<meta property="article:modified_time" content="2022-10-26T09:28:54.066Z">
<meta property="article:author" content="moqiang">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">自强不息</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://moqiang02.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-使用Cobra创建CLI应用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/11/07/%E4%BD%BF%E7%94%A8Cobra%E5%88%9B%E5%BB%BACLI%E5%BA%94%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2021-11-07T12:34:56.000Z" itemprop="datePublished">2021-11-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/go/">go</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      使用Cobra创建CLI应用
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      

          <!-- rex -->
          
            <!-- 文章目录开始 -->
            
              <div id="toc" class="toc-article">
              <strong class="toc-title" style="cursor:pointer">目录</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rootCmd"><span class="toc-number">2.1.</span> <span class="toc-text">rootCmd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#init"><span class="toc-number">2.2.</span> <span class="toc-text">init</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#initConfig"><span class="toc-number">2.3.</span> <span class="toc-text">initConfig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">2.4.</span> <span class="toc-text">添加数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%81%B6%E6%95%B0"><span class="toc-number">2.5.</span> <span class="toc-text">添加偶数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">3.</span> <span class="toc-text">参考资料</span></a></li></ol>
              </div>
            
            <!-- 文章目录结束 -->	  
          

        <p>虽然现在我们使用的大多数软件都是可视化的，很容易上手，但是这并不代表 CLI（命令行）应用就没有用武之地了，特别是对于开发人员来说，还是会经常和 CLI 应用打交道。而 Golang 就非常适合用来构建 CLI 应用，下面我们就将来介绍如何在 Golang 中构建一个 CLI 应用。</p>
<p>对于开发人员来说平时可能就需要使用到很多 CLI 工具，比如 npm、node、go、python、docker、kubectl 等等，因为这些工具非常小巧、没有依赖性、非常适合系统管理或者一些自动化任务等等。</p>
<p>我们这里选择使用 Golang 里面非常有名的 <a target="_blank" rel="noopener" href="https://github.com/spf13/cobra">Cobra</a> 库来进行 CLI 工具的开发。Cobra 是一个功能强大的现代化 CLI 应用程序库，有很多知名的 Go 项目使用 Cobra 进行构建，比如：Kubernetes、Docker、Hugo 等等<span id="more"></span></p>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>Cobra 是构建在命令、参数和标识符之上的：</p>
<ul>
<li>  <code>Commands</code> 表示执行动作</li>
<li>  <code>Args</code> 就是执行参数</li>
<li>  <code>Flags</code> 是这些动作的标识符</li>
</ul>
<p>基本的执行命令如下所示：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ APPNAME Command Args <span class="comment">--Flags</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ APPNAME Command <span class="comment">--Flags Args</span></span><br></pre></td></tr></table></figure>

<p>比如我们平时使用的一些命令行工具：</p>
<ul>
<li>  git clone URL -bare</li>
<li>  go get -u URL</li>
<li>  npm install package –save</li>
<li>  kubectl get pods -n kube-system -l app=cobra</li>
</ul>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>下面我们来看下 Cobra 的使用，这里我们使用的 go1.13.3 版本，使用 Go Modules 来进行包管理，如果对这部分知识点不熟悉的，可以查看前面我们的文章 <a target="_blank" rel="noopener" href="https://www.qikqiak.com/post/go-modules-usage/">Go Modules 基本使用（视频）</a> 了解。</p>
<p>新建一个名为 <code>my-calc</code> 的目录作为项目目录，然后初始化 modules：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> my-calc &amp;&amp; <span class="keyword">cd</span> my-calc</span><br><span class="line"># 如果 <span class="keyword">go</span> modules 默认没有开启，需要执行 export GO111MODULE=<span class="keyword">on</span> 开启</span><br><span class="line">$ <span class="keyword">go</span> <span class="keyword">mod</span> init my-calc</span><br><span class="line"><span class="keyword">go</span>: creating <span class="keyword">new</span> <span class="keyword">go</span>.<span class="keyword">mod</span>: module my-calc</span><br></pre></td></tr></table></figure>

<p>初始化完成后可以看到项目根目录下面多了一个 <code>go.mod</code> 的文件，现在我们还没有安装 <code>cobra</code> 库，执行下面的命令进行安装：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 强烈推荐配置该环境变量</span></span><br><span class="line">$ <span class="built_in">export</span> <span class="attribute">GOPROXY</span>=https://goproxy.cn</span><br><span class="line">$ go <span class="built_in">get</span> -u github.com/spf13/cobra/cobra</span><br></pre></td></tr></table></figure>

<p>安装成功后，现在我们可以使用 <code>cobra init</code> 命令来初始化 CLI 应用的脚手架：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cobra init --pkg-name my-calc</span><br><span class="line">Your Cobra applicaton is ready at</span><br><span class="line"><span class="regexp">/Users/y</span>ch<span class="regexp">/devs/</span>workspace<span class="regexp">/youdianzhishi/</span>course/my-calc</span><br></pre></td></tr></table></figure>

<p>需要注意的是新版本的 cobra 库需要提供一个 <code>--pkg-name</code> 参数来进行初始化，也就是指定上面我们初始化的模块名称即可。上面的 init 命令就会创建出一个最基本的 CLI 应用项目：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ tree .</span><br><span class="line">.</span><br><span class="line">├── LICENSE</span><br><span class="line">├── cmd</span><br><span class="line">│   └── root.<span class="built_in">go</span></span><br><span class="line">├── <span class="built_in">go</span>.<span class="built_in">mod</span></span><br><span class="line">├── <span class="built_in">go</span>.<span class="built_in">sum</span></span><br><span class="line">└── main.<span class="built_in">go</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="built_in">directory</span>, <span class="number">5</span> files</span><br></pre></td></tr></table></figure>

<p>其中 <code>main.go</code> 是 CLI 应用的入口，在 <code>main.go</code> 里面调用好了 <code>cmd/root.go</code> 下面的 <code>Execute</code> 函数：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;my-calc/cmd&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    cmd.Execute()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们再来看下 <code>cmd/root.go</code> 文件。</p>
<h3 id="rootCmd"><a href="#rootCmd" class="headerlink" title="rootCmd"></a>rootCmd</h3><p>root（根）命令是 CLI 工具的最基本的命令，比如对于我们前面使用的 <code>go get URL</code>，其中 <code>go</code> 就是 root 命令，而 <code>get</code> 就是 <code>go</code> 这个根命令的子命令，而在 <code>root.go</code> 中就直接使用了 cobra 命令来初始化 <code>rootCmd</code> 结构，CLI 中的其他所有命令都将是 <code>rootCmd</code> 这个根命令的子命令了。</p>
<p>这里我们将 <code>cmd/root.go</code> 里面的 <code>rootCmd</code> 变量内部的注释去掉，并在 <code>Run</code> 函数里面加上一句 <code>fmt.Println(&quot;Hello Cobra CLI&quot;)</code>：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rootCmd = &amp;cobra.Command&#123;</span><br><span class="line">    Use:   <span class="string">&quot;my-calc&quot;</span>,</span><br><span class="line">    Short: <span class="string">&quot;A brief description of your application&quot;</span>,</span><br><span class="line">    Long: <span class="string">`A longer description that spans multiple lines and likely contains</span></span><br><span class="line"><span class="string">examples and usage of using your application. For example:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Cobra is a CLI library for Go that empowers applications.</span></span><br><span class="line"><span class="string">This application is a tool to generate the needed files</span></span><br><span class="line"><span class="string">to quickly create a Cobra application.`</span>,</span><br><span class="line">    Run: <span class="function"><span class="keyword">func</span><span class="params">(cmd *cobra.Command, args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;Hello Cobra CLI&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候我们在项目根目录下面执行如下命令进行构建：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go build -o <span class="keyword">my</span>-calc</span><br></pre></td></tr></table></figure>

<p>该命令会在项目根目录下生成一个名为 <code>my-calc</code> 的二进制文件，直接执行这个二进制文件可以看到如下所示的输出信息：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> ./my<span class="literal">-calc</span></span><br><span class="line">Hello Cobra <span class="built_in">CLI</span></span><br></pre></td></tr></table></figure>

<h3 id="init"><a href="#init" class="headerlink" title="init"></a>init</h3><p>我们知道 <code>init</code> 函数是 Golang 中初始化包的时候第一个调用的函数。在 <code>cmd/root.go</code> 中我们可以看到 <code>init</code> 函数中调用了 <code>cobra.OnInitialize(initConfig)</code>，也就是每当执行或者调用命令的时候，它都会先执行 <code>init</code> 函数中的所有函数，然后再执行 <code>execute</code> 方法。该初始化可用于加载配置文件或用于构造函数等等，这完全依赖于我们应用的实际情况。</p>
<p>在初始化函数里面 <code>cobra.OnInitialize(initConfig)</code> 调用了 <code>initConfig</code> 这个函数，所有，当 <code>rootCmd</code> 的执行方法 <code>RUN: func</code> 运行的时候，<code>rootCmd</code> 根命令就会首先运行 <code>initConfig</code> 函数，当所有的初始化函数执行完成后，才会执行 <code>rootCmd</code> 的 <code>RUN: func</code> 执行函数。</p>
<p>我们可以在 <code>initConfig</code> 函数里面添加一些 Debug 信息：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initConfig</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;I&#x27;m inside initConfig function in cmd/root.go&quot;</span>)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后同样重新构建一次再执行：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ go build -o my-calc</span><br><span class="line">$ ./my-calc</span><br><span class="line">I<span class="symbol">&#x27;m</span> inside initConfig <span class="keyword">function</span> <span class="title">in</span> cmd/root.go</span><br><span class="line">Hello Cobra CLI</span><br></pre></td></tr></table></figure>

<p>可以看到是首先运行的是 <code>initConfig</code> 函数里面的信息，然后才是真正的执行函数里面的内容。</p>
<p>为了搞清楚整个 CLI 执行的流程，我们在 <code>main.go</code> 里面也添加一些 Debug 信息：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/root.go</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;I&#x27;m inside init function in cmd/root.go&quot;</span>)</span><br><span class="line">    cobra.OnInitialize(initConfig)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initConfig</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;I&#x27;m inside initConfig function in cmd/root.go&quot;</span>)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.go</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">     fmt.Println(<span class="string">&quot;I&#x27;m inside main function in main.go&quot;</span>)</span><br><span class="line">     cmd.Execute()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后同样重新构建一次再执行：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ go build -o my-calc</span><br><span class="line">$ ./my-calc</span><br><span class="line">I<span class="symbol">&#x27;m</span> inside init <span class="keyword">function</span> <span class="title">in</span> cmd/root.go</span><br><span class="line">I&#x27;m inside main <span class="keyword">function</span> <span class="title">in</span> main.go</span><br><span class="line">I&#x27;m inside initConfig <span class="keyword">function</span> <span class="title">in</span> cmd/root.go</span><br><span class="line">Hello Cobra CLI</span><br></pre></td></tr></table></figure>

<p>根据上面的日志信息我们就可以了解到 CLI 命令的流程了。</p>
<p><code>init</code> 函数最后处理的就是 <code>flags</code> 了，<code>Flags</code> 就类似于命令的标识符，我们可以把他们看成是某种条件操作，在 Cobra 中提供了两种类型的标识符：<code>Persistent Flags</code> 和 <code>Local Flags</code>。</p>
<ul>
<li>  <code>Persistent Flags</code>: 该标志可用于为其分配的命令以及该命令的所有子命令。</li>
<li>  <code>Local Flags</code>: 该标志只能用于分配给它的命令。</li>
</ul>
<h3 id="initConfig"><a href="#initConfig" class="headerlink" title="initConfig"></a>initConfig</h3><p>该函数主要用于在 home 目录下面设置一个名为 <code>.my-calc</code> 的配置文件，如果该文件存在则会使用这个配置文件。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/root.go</span></span><br><span class="line"><span class="comment">// initConfig 读取配置文件和环境变量</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">initConfig</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> cfgFile != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">        <span class="comment">// 使用 flag 标志中传递的配置文件</span></span><br><span class="line">        viper.SetConfigFile(cfgFile)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 获取 Home 目录</span></span><br><span class="line">        home, err := homedir.Dir()</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            fmt.Println(err)</span><br><span class="line">            os.Exit(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 在 Home 目录下面查找名为 &quot;.my-calc&quot; 的配置文件</span></span><br><span class="line">        viper.AddConfigPath(home)</span><br><span class="line">        viper.SetConfigName(<span class="string">&quot;.my-calc&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 读取匹配的环境变量</span></span><br><span class="line">    viper.AutomaticEnv()</span><br><span class="line">    <span class="comment">// 如果有配置文件，则读取它</span></span><br><span class="line">    <span class="keyword">if</span> err := viper.ReadInConfig(); err == <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;Using config file:&quot;</span>, viper.ConfigFileUsed())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>viper</code> 是一个非常优秀的用于解决配置文件的 Golang 库，它可以从 JSON、TOML、YAML、HCL、envfile 以及 Java properties 配置文件中读取信息，功能非常强大，而且不仅仅是读取配置这么简单，了解更多相关信息可以查看 Git 仓库相关介绍：<a target="_blank" rel="noopener" href="https://github.com/spf13/viper">https://github.com/spf13/viper</a>。</p>
<p>现在我们可以去掉前面我们添加的一些打印语句，我们已经创建了一个 <code>my-calc</code> 命令作为 <code>rootCmd</code> 命令，执行该根命令会打印 <code>Hello Cobra CLI</code> 信息，接下来为我们的 CLI 应用添加一些其他的命令。</p>
<h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><p>在项目根目录下面创建一个名为 <code>add</code> 的命令，<code>Cobra</code> 添加一个新的命令的方式为：<code>cobra add &lt;commandName&gt;</code>，所以我们这里直接这样执行：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cobra <span class="built_in">add</span> <span class="built_in">add</span></span><br><span class="line"><span class="built_in">add</span> created at /Users/ych/devs/workspace/youdianzhishi/course/my-calc</span><br><span class="line">$ tree .</span><br><span class="line">.</span><br><span class="line">├── LICENSE</span><br><span class="line">├── cmd</span><br><span class="line">│   ├── <span class="built_in">add</span>.<span class="keyword">go</span></span><br><span class="line">│   └── root.<span class="keyword">go</span></span><br><span class="line">├── <span class="keyword">go</span>.<span class="keyword">mod</span></span><br><span class="line">├── <span class="keyword">go</span>.sum</span><br><span class="line">├── main.<span class="keyword">go</span></span><br><span class="line">└── my-calc</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> directory, <span class="number">7</span> <span class="keyword">files</span></span><br></pre></td></tr></table></figure>

<p>现在我们可以看到 <code>cmd/root.go</code> 文件中新增了一个 <code>add.go</code> 的文件，我们仔细观察可以发现该文件和 <code>cmd/root.go</code> 比较类似。首先是声明了一个名为 <code>addCmd</code> 的结构体变量，类型为 <code>*cobra.Command</code> 指针类型，<code>*cobra.Command</code> 有一个 <code>RUN</code> 函数，带有 <code>*cobra.Command</code> 指针和一个字符串切片参数。</p>
<p>然后在 <code>init</code> 函数中进行初始化，初始化后，将其添加到 <code>rootCmd</code> 根命令中 <code>rootCmd.AddCommand(addCmd)</code>，所以我们可以把 <code>addCmd</code> 看成是 <code>rootCmd</code> 的子命令。</p>
<p>同样现在重新构建应用再执行:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go build -o my-calc</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./my-calc</span></span><br><span class="line">Hello Cobra CLI</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./my-calc add</span></span><br><span class="line">add called</span><br></pre></td></tr></table></figure>

<p>可以看到 <code>add</code> 命令可以正常运行了，接下来我们来让改命令支持添加一些数字，我们知道在 <code>RUN</code> 函数中是用户字符串 slice 来作为参数的，所以要支持添加数字，我们首先需要将字符串转换为 int 类型，返回返回计算结果。 在 <code>cmd/add.go</code> 文件中添加一个名为 <code>intAdd</code> 的函数，定义如下所示：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/add.go</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">intAdd</span><span class="params">(args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> sum <span class="type">int</span></span><br><span class="line">    <span class="comment">// 循环 args 参数，循环的第一个值为 args 的索引，这里我们不需要，所以用 _ 忽略掉</span></span><br><span class="line">    <span class="keyword">for</span> _, ival := <span class="keyword">range</span> args &#123;</span><br><span class="line">        <span class="comment">// 将 string 转换成 int 类型</span></span><br><span class="line">        temp, err := strconv.Atoi(ival)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">panic</span>(err)</span><br><span class="line">        &#125;</span><br><span class="line">        sum = sum + temp</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;Addition of numbers %s is %d\n&quot;</span>, args, sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在 <code>addCmd</code> 变量中，更新 <code>RUN</code> 函数，移除默认的打印信息，调用上面声明的 <code>addInt</code> 函数：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// addCmd</span></span><br><span class="line">Run: <span class="function"><span class="keyword">func</span><span class="params">(cmd *cobra.Command, args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    intAdd(args)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>然后重新构建应用执行如下所示的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go build -o my-calc</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./my-calc</span></span><br><span class="line">Hello Cobra CLI</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">注意参数之间的空格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./my-calc add 1 2 3</span></span><br><span class="line">Addition of numbers [1 2 3] is 6</span><br></pre></td></tr></table></figure>

<p>由于 <code>RUN</code> 函数中的 <code>args</code> 参数是一个字符串切片，所以我们可以传递任意数量的参数，但是确有一个缺陷，就是只能进行整数计算，不能计算小数，比如我们执行如下的计算就会直接 panic 了:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./<span class="keyword">my</span>-calc add <span class="number">1</span> <span class="number">2</span> <span class="number">3.5</span></span><br><span class="line">panic: strconv.Atoi: parsing <span class="string">&quot;3.5&quot;</span>: invalid syntax</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [<span class="built_in">running</span>]:</span><br><span class="line"><span class="keyword">my</span>-calc/cmd.intAdd(<span class="number">0xc0000a5890</span>, <span class="number">0x3</span>, <span class="number">0x3</span>)</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>因为在 <code>intAdd</code> 函数里面，我们只是将字符串转换成了 int，而不是 float32/64 类型，所以我们可以为 <code>addCmd</code> 命令添加一个 <code>flag</code> 标识符，通过该标识符来帮助 CLI 确定它是 int 计算还是 float 计算。</p>
<p>在 <code>cmd/add.go</code> 文件的 <code>init</code> 函数内部，我们创建一个 Bool 类型的本地标识符，命名成 <code>float</code>，简写成 <code>f</code>，默认值为 false。这个默认值是非常重要的，意思就是即使没有在命令行中调用 flag 标识符，该标识符的值就将为 false。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/add.go</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    rootCmd.AddCommand(addCmd)</span><br><span class="line">    addCmd.Flags().BoolP(<span class="string">&quot;float&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;Add Floating Numbers&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后创建一个 <code>floatAdd</code> 的函数：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">floatAdd</span><span class="params">(args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> sum <span class="type">float64</span></span><br><span class="line">    <span class="keyword">for</span> _, fval := <span class="keyword">range</span> args &#123;</span><br><span class="line">        <span class="comment">// 将字符串转换成 float64 类型</span></span><br><span class="line">        temp, err := strconv.ParseFloat(fval, <span class="number">64</span>)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">panic</span>(err)</span><br><span class="line">        &#125;</span><br><span class="line">        sum = sum + temp</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;Sum of floating numbers %s is %f\n&quot;</span>, args, sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该函数和上面的 <code>intAdd</code> 函数几乎是相同的，除了是将字符串转换成 float64 类型。然后在 <code>addCmd</code> 的 <code>RUN</code> 函数中，我们根据传入的标识符来判断到底应该是调用 <code>intAdd</code> 还是 <code>floatAdd</code>，如果传递了 <code>--float</code> 或者 <code>-f</code> 标志，就将会调用 <code>floatAdd</code> 函数。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/add.go</span></span><br><span class="line"><span class="comment">// addCmd</span></span><br><span class="line">Run: <span class="function"><span class="keyword">func</span><span class="params">(cmd *cobra.Command, args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 获取 float 标识符的值，默认为 false</span></span><br><span class="line">    fstatus, _ := cmd.Flags().GetBool(<span class="string">&quot;float&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> fstatus &#123; <span class="comment">// 如果为 true，则调用 floatAdd 函数</span></span><br><span class="line">        floatAdd(args)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        intAdd(args)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>现在重新编译构建 CLI 应用，按照如下方式执行：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ go build -o <span class="keyword">my</span>-calc</span><br><span class="line">$ ./<span class="keyword">my</span>-calc add <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">Addition <span class="keyword">of</span> numbers [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>] <span class="keyword">is</span> <span class="number">6</span></span><br><span class="line">$ ./<span class="keyword">my</span>-calc add <span class="number">1</span> <span class="number">2</span> <span class="number">3.5</span> -f</span><br><span class="line">Sum <span class="keyword">of</span> floating numbers [<span class="number">1</span> <span class="number">2</span> <span class="number">3.5</span>] <span class="keyword">is</span> <span class="number">6.500000</span></span><br><span class="line">$./<span class="keyword">my</span>-calc add <span class="number">1</span> <span class="number">2</span> <span class="number">3.5</span> <span class="comment">--float</span></span><br><span class="line">Sum <span class="keyword">of</span> floating numbers [<span class="number">1</span> <span class="number">2</span> <span class="number">3.5</span>] <span class="keyword">is</span> <span class="number">6.500000</span></span><br></pre></td></tr></table></figure>

<p>然后接下来我们在给 <code>addCmd</code> 添加一些子命令来扩展它。</p>
<h3 id="添加偶数"><a href="#添加偶数" class="headerlink" title="添加偶数"></a>添加偶数</h3><p>同样在项目根目录下执行如下命令添加一个名为 <code>even</code> 的命令：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cobra add even</span><br><span class="line">even created at <span class="regexp">/Users/y</span>ch<span class="regexp">/devs/</span>workspace<span class="regexp">/youdianzhishi/</span>course/my-calc</span><br></pre></td></tr></table></figure>

<p>和上面一样会在 <code>root</code> 目录下面新增一个名为 <code>even.go</code> 的文件，修改该文件中的 <code>init</code> 函数，将 <code>rootCmd</code> 修改为 <code>addCmd</code>，因为我们是为 <code>addCmd</code> 添加子命令:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/even.go</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    addCmd.AddCommand(evenCmd)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后更新 <code>evenCmd</code> 结构体参数的 <code>RUN</code> 函数:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cmd/even.go</span></span><br><span class="line">Run: <span class="function"><span class="keyword">func</span><span class="params">(cmd *cobra.Command, args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> evenSum <span class="type">int</span></span><br><span class="line">    <span class="keyword">for</span> _, ival := <span class="keyword">range</span> args &#123;</span><br><span class="line">        temp, _ := strconv.Atoi(ival)</span><br><span class="line">        <span class="keyword">if</span> temp%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">            evenSum = evenSum + temp</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;The even addition of %s is %d\n&quot;</span>, args, evenSum)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>首先将字符串转换成整数，然后判断如果是偶数才进行累加。然后重新编译构建应用:</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ go build -o my-calc</span><br><span class="line">$ ./my-calc add even<span class="number"> 1 </span>2<span class="number"> 3 </span>4<span class="number"> 5 </span>6</span><br><span class="line">The even addition of [1<span class="number"> 2 </span>3<span class="number"> 4 </span>5 6] is 12</span><br></pre></td></tr></table></figure>

<p><code>my-calc</code> 是我们的根命令，<code>add</code> 是 <code>rootCmd</code> 的子命令，<code>even</code> 优势 <code>addCmd</code> 的子命令，所以按照上面的方式调用。可以用同样的方式再去添加一个奇数相加的子命令。</p>
<p>到这里我们就在 Golang 里面使用 <code>Cobra</code> 创建了一个简单的 CLI 应用。本文的内容虽然比较简单，但是是我们了解学习 <code>Cobra</code> 基础的一个很好的入门方式，后续我们也可以尝试添加一些更加复杂的使用案例。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li>  <a target="_blank" rel="noopener" href="https://github.com/spf13/cobra">https://github.com/spf13/cobra</a></li>
<li>  <a target="_blank" rel="noopener" href="https://github.com/spf13/viper">https://github.com/spf13/viper</a></li>
<li>  <a target="_blank" rel="noopener" href="https://schadokar.dev/posts/how-to-create-a-cli-in-golang-with-cobra/">How to create a CLI in golang with cobra</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://moqiang02.github.io/2021/11/07/%E4%BD%BF%E7%94%A8Cobra%E5%88%9B%E5%BB%BACLI%E5%BA%94%E7%94%A8/" data-id="cla0v66ad01qeg0v14q9p0qno" data-title="使用Cobra创建CLI应用" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/11/10/Mac%E4%B8%8Bbrew%E5%88%87%E6%8D%A2%E4%B8%BA%E5%9B%BD%E5%86%85%E6%BA%90/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          Mac下brew切换为国内源
        
      </div>
    </a>
  
  
    <a href="/2021/11/05/Go-Context/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">Go Context</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">255</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/apache/">apache</a><span class="category-list-count">27</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/github%E5%8D%9A%E5%AE%A2/">github博客</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/html-css/">html+css</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iis/">iis</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">78</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><span class="category-list-count">115</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kotlin/">kotlin</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">68</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/memcached/">memcached</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">72</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a><span class="category-list-count">41</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nodejs/">nodejs</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a><span class="category-list-count">185</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">44</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E5%AE%83/">其它</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a><span class="category-list-count">51</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">开源项目</a><span class="category-list-count">73</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/">生活随笔</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/">量化交易</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AndroidStudio/" style="font-size: 13.33px;">AndroidStudio</a> <a href="/tags/AndroidUI/" style="font-size: 20px;">AndroidUI</a> <a href="/tags/Android%E4%BA%8B%E4%BB%B6%E6%8B%A6%E6%88%AA/" style="font-size: 11.11px;">Android事件拦截</a> <a href="/tags/Android%E5%BC%80%E6%BA%90/" style="font-size: 17.22px;">Android开源</a> <a href="/tags/CI/" style="font-size: 15px;">CI</a> <a href="/tags/CURL/" style="font-size: 12.78px;">CURL</a> <a href="/tags/DEDE/" style="font-size: 18.33px;">DEDE</a> <a href="/tags/Docker/" style="font-size: 14.44px;">Docker</a> <a href="/tags/Flask/" style="font-size: 10.56px;">Flask</a> <a href="/tags/JavaSE/" style="font-size: 18.89px;">JavaSE</a> <a href="/tags/Laravel/" style="font-size: 17.22px;">Laravel</a> <a href="/tags/Maven/" style="font-size: 11.11px;">Maven</a> <a href="/tags/MybatisPlus/" style="font-size: 11.11px;">MybatisPlus</a> <a href="/tags/SVN/" style="font-size: 10px;">SVN</a> <a href="/tags/SpringBoot/" style="font-size: 19.44px;">SpringBoot</a> <a href="/tags/Thinkphp/" style="font-size: 10px;">Thinkphp</a> <a href="/tags/UEditor/" style="font-size: 11.67px;">UEditor</a> <a href="/tags/VMware/" style="font-size: 12.22px;">VMware</a> <a href="/tags/Vue/" style="font-size: 17.78px;">Vue</a> <a href="/tags/WebSocket/" style="font-size: 12.78px;">WebSocket</a> <a href="/tags/ecshop/" style="font-size: 14.44px;">ecshop</a> <a href="/tags/scrapy/" style="font-size: 13.89px;">scrapy</a> <a href="/tags/smarty/" style="font-size: 12.22px;">smarty</a> <a href="/tags/socket/" style="font-size: 14.44px;">socket</a> <a href="/tags/sphinx/" style="font-size: 11.67px;">sphinx</a> <a href="/tags/vagrant/" style="font-size: 12.22px;">vagrant</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 11.11px;">微服务</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93/" style="font-size: 15px;">数据传输</a> <a href="/tags/%E6%AD%A3%E5%88%99/" style="font-size: 11.67px;">正则</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 15.56px;">消息队列</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 16.11px;">爬虫</a> <a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 16.67px;">集群</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/02/24/Java%E6%96%B9%E6%B3%95%E4%BC%A0%E5%8F%82%E5%88%B0%E5%BA%95%E4%BC%A0%E6%89%80%E9%9C%80%E5%8F%82%E6%95%B0%E5%A5%BD%E8%BF%98%E6%98%AF%E4%BC%A0%E5%AE%9E%E4%BD%93%E5%A5%BD%EF%BC%9F/">Java方法传参到底传所需参数好还是传实体好？</a>
          </li>
        
          <li>
            <a href="/2023/02/09/Java8%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B8%AD%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/">Java8集合框架中的新方法</a>
          </li>
        
          <li>
            <a href="/2023/01/22/APM%E8%B0%83%E7%A0%94/">APM调研</a>
          </li>
        
          <li>
            <a href="/2023/01/22/linux-%E7%AE%80%E5%8D%95%E7%9A%84mysql%E5%A4%87%E4%BB%BD%E5%92%8C%E5%AF%BC%E5%85%A5%EF%BC%8C%E4%BB%A5%E5%8F%8A%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%87%E4%BB%BD%E5%92%8C%E5%AF%BC%E5%85%A5/">linux 简单的mysql备份和导入，以及文件的备份和导入</a>
          </li>
        
          <li>
            <a href="/2023/01/15/ThreadLocal%E8%AF%A6%E8%A7%A3/">ThreadLocal详解</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 moqiang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>

<!-- rex -->

<script src="/js/toc.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>