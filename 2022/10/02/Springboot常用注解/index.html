<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Springboot常用注解 | 自强不息</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="咱们继续《Spring江湖路》第 7 回，持续更新中…..  本文提供完整代码示例，详见 https:&#x2F;&#x2F;gitee.com&#x2F;isevenluo&#x2F;spring-road&#x2F; 的 spring-road04 目录。  0. 写在前面应粉丝的要求呀，咱们这篇文章就安排上对 Spring Boot 常用注解的和含义和用法的讲解。七哥确实是用心了，花了一个周末的时间，毫不夸张的说，你只要掌握了这些注解，应付">
<meta property="og:type" content="article">
<meta property="og:title" content="Springboot常用注解">
<meta property="og:url" content="http://moqiang02.github.io/2022/10/02/Springboot%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/index.html">
<meta property="og:site_name" content="自强不息">
<meta property="og:description" content="咱们继续《Spring江湖路》第 7 回，持续更新中…..  本文提供完整代码示例，详见 https:&#x2F;&#x2F;gitee.com&#x2F;isevenluo&#x2F;spring-road&#x2F; 的 spring-road04 目录。  0. 写在前面应粉丝的要求呀，咱们这篇文章就安排上对 Spring Boot 常用注解的和含义和用法的讲解。七哥确实是用心了，花了一个周末的时间，毫不夸张的说，你只要掌握了这些注解，应付">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://moqiang02.github.io/images/Springboot%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/1.png">
<meta property="article:published_time" content="2022-10-02T07:07:54.000Z">
<meta property="article:modified_time" content="2022-10-26T09:28:53.896Z">
<meta property="article:author" content="moqiang">
<meta property="article:tag" content="SpringBoot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://moqiang02.github.io/images/Springboot%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/1.png">
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">自强不息</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://moqiang02.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Springboot常用注解" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/02/Springboot%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/" class="article-date">
  <time class="dt-published" datetime="2022-10-02T07:07:54.000Z" itemprop="datePublished">2022-10-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Springboot常用注解
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      

          <!-- rex -->
          
            <!-- 文章目录开始 -->
            
              <div id="toc" class="toc-article">
              <strong class="toc-title" style="cursor:pointer">目录</strong>
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">0. 写在前面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%9B%AE%E5%BD%95"><span class="toc-number">2.</span> <span class="toc-text">1. 目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Bean%E5%A4%84%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">2. Bean处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource"><span class="toc-number">3.1.</span> <span class="toc-text">@Resource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Component%E3%80%81-Repository%E3%80%81-Service%E3%80%81-Controller%E3%80%81-RestController"><span class="toc-number">3.2.</span> <span class="toc-text">@Component、@Repository、@Service、@Controller、@RestController</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Configuration"><span class="toc-number">3.3.</span> <span class="toc-text">@Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Scope"><span class="toc-number">3.4.</span> <span class="toc-text">@Scope</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-HTTP%E8%AF%B7%E6%B1%82"><span class="toc-number">4.</span> <span class="toc-text">3. HTTP请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GetMapping"><span class="toc-number">4.1.</span> <span class="toc-text">@GetMapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PostMapping"><span class="toc-number">4.2.</span> <span class="toc-text">@PostMapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PutMapping"><span class="toc-number">4.3.</span> <span class="toc-text">@PutMapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DeleteMapping"><span class="toc-number">4.4.</span> <span class="toc-text">@DeleteMapping</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-number">5.</span> <span class="toc-text">4. 前后端参数传递</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RequestParam-%E5%92%8C-PathVariable"><span class="toc-number">5.1.</span> <span class="toc-text">@RequestParam 和 @PathVariable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RequestBody"><span class="toc-number">5.2.</span> <span class="toc-text">@RequestBody</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ResponseBody"><span class="toc-number">5.3.</span> <span class="toc-text">@ResponseBody</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE"><span class="toc-number">6.</span> <span class="toc-text">5. 读取配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#value"><span class="toc-number">6.1.</span> <span class="toc-text">@value</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ConfigurationProperties-%E9%87%8D%E7%82%B9"><span class="toc-number">6.2.</span> <span class="toc-text">@ConfigurationProperties(重点)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PropertySource"><span class="toc-number">6.3.</span> <span class="toc-text">@PropertySource</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C"><span class="toc-number">7.</span> <span class="toc-text">6. 参数校验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Bean%E5%AD%97%E6%AE%B5%E9%AA%8C%E8%AF%81%E6%B3%A8%E8%A7%A3"><span class="toc-number">7.1.</span> <span class="toc-text">Bean字段验证注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E8%AF%B7%E6%B1%82%E4%BD%93-RequestBody"><span class="toc-number">7.2.</span> <span class="toc-text">验证请求体(RequestBody)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Validated"><span class="toc-number">7.3.</span> <span class="toc-text">@Validated</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">7. 统一异常处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-JPA%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">9.</span> <span class="toc-text">8. JPA数据持久化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">9.1.</span> <span class="toc-text">创建表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%94%AE"><span class="toc-number">9.2.</span> <span class="toc-text">创建主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B"><span class="toc-number">9.3.</span> <span class="toc-text">设置字段类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%B8%8D%E6%8C%81%E4%B9%85%E5%8C%96%E7%89%B9%E5%AE%9A%E5%AD%97%E6%AE%B5"><span class="toc-number">9.4.</span> <span class="toc-text">指定不持久化特定字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E4%BA%8B%E5%8A%A1"><span class="toc-number">9.5.</span> <span class="toc-text">@声明事务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-JSON%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">9. JSON格式处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E8%BF%87%E6%BB%A4%E5%AD%97%E6%AE%B5"><span class="toc-number">10.1.</span> <span class="toc-text">指定过滤字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96-json-%E6%95%B0%E6%8D%AE"><span class="toc-number">10.2.</span> <span class="toc-text">格式化 json 数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%81%E5%B9%B3%E5%8C%96%E5%AF%B9%E8%B1%A1"><span class="toc-number">10.3.</span> <span class="toc-text">扁平化对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E6%B5%8B%E8%AF%95%E5%A4%84%E7%90%86"><span class="toc-number">11.</span> <span class="toc-text">10. 测试处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E9%85%8D%E7%BD%AE%E5%90%AF%E5%8A%A8"><span class="toc-number">12.</span> <span class="toc-text">11. 配置启动</span></a></li></ol>
              </div>
            
            <!-- 文章目录结束 -->	  
          

        <p>咱们继续<a target="_blank" rel="noopener" href="https://github.com/isevenluo/spring-road">《Spring江湖路》</a>第 <strong>7</strong> 回，持续更新中…..</p>
<blockquote>
<p>本文提供完整代码示例，详见 <a target="_blank" rel="noopener" href="https://gitee.com/isevenluo/spring-road/">https://gitee.com/isevenluo/spring-road/</a> 的 spring-road04 目录。</p>
</blockquote>
<h3 id="0-写在前面"><a href="#0-写在前面" class="headerlink" title="0. 写在前面"></a>0. 写在前面</h3><p>应粉丝的要求呀，咱们这篇文章就安排上对 Spring Boot 常用注解的和含义和用法的讲解。七哥确实是用心了，花了一个周末的时间，毫不夸张的说，你只要掌握了这些注解，应付你平时的工作开发绝对是游刃有余了。</p>
<p>那值得一提的是，今天我们不仅聊注解的含义，而且附带了具体的用法，目的就是让大家掌握搞懂，看了就能用上。快来，夸七哥贴心！</p>
<p>那虽然七哥这次是花了很多时间才整理好，但是毕竟因为个人能力和精力有限，总归有遗漏之处，就当是引玉抛砖了，有任何问题或者需要补充的，大家留言哈。<span id="more"></span></p>
<p>那就不废话了，开搞。</p>
<h3 id="1-目录"><a href="#1-目录" class="headerlink" title="1. 目录"></a>1. 目录</h3><p><img src="/images/Springboot%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/1.png"></p>
<p>可以看到七哥给大家整理的目录，我个人觉得还是比较清晰的，也尽可能的完善了，我带着大家过一遍，整清楚了含义和用法，剩下的就交给你们去实战了。</p>
<h3 id="2-Bean处理"><a href="#2-Bean处理" class="headerlink" title="2. Bean处理"></a>2. Bean处理</h3><p>下面这些注解都是处理 Spring 中 Bean 相关的。</p>
<h4 id="Resource"><a href="#Resource" class="headerlink" title="@Resource"></a><code>@Resource</code></h4><blockquote>
<p>依赖注入，自动导入标注的对象到当前类中，比如我们的 Controller 类通常要导入 Service 类（需要注意这里 Service 类要被 Spring 容器管理）。</p>
</blockquote>
<h4 id="Component、-Repository、-Service、-Controller、-RestController"><a href="#Component、-Repository、-Service、-Controller、-RestController" class="headerlink" title="@Component、@Repository、@Service、@Controller、@RestController"></a><code>@Component</code>、<code>@Repository</code>、<code>@Service</code>、<code>@Controller</code>、<code>@RestController</code></h4><blockquote>
<p>我们一般使用 <code>@Resource</code> 注解让 Spring 容器帮我们自动装配 bean。要想把类标识成可用于 <code>@Resource</code> 注解自动装配的 bean 就需要我们使用这几个注解了，它们表示对应的类将被 Spring 容器管理。</p>
</blockquote>
<ul>
<li><p>  <code>@Component</code> ：通用的注解，可标注任意类为 <code>Spring</code> 组件。如果一个 Bean 不知道属于哪个层，可以使用<code>@Component</code> 注解标注；</p>
</li>
<li><p>  <code>@Repository</code> : 对应持久层即 Dao 层，主要用于数据库相关操作；</p>
</li>
<li><p>  <code>@Service</code> : 对应服务层，主要涉及一些复杂的逻辑，需要用到 Dao 层；</p>
</li>
<li><p>  <code>@Controller</code> : 对应 Spring MVC 控制层，一般需要注入 Service 类返回结果数据；</p>
</li>
<li><p>  <code>@RestController</code> : 继承于 @Controller，区别在于标注后整个类所有方法将直接返回 JSON 数据，不再需要视图解析处理，目前前后端分离的项目后端都是直接用这个注解的；</p>
</li>
</ul>
<h4 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a><code>@Configuration</code></h4><blockquote>
<p>标注是 Java 代码的配置类， Spring Boot 中推荐这种做法不再使用 xml 配置了；</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span> &#123;</span><br><span class="line">   <span class="comment">//相当于 xml 中配置 Bean</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> TransferService <span class="title function_">transferService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TransferServiceImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Scope"><a href="#Scope" class="headerlink" title="@Scope"></a><code>@Scope</code></h4><p>声明 Spring Bean 的作用域,作用于一共有以下几种：</p>
<ul>
<li><p>  singleton：唯一 bean 实例，Spring 中的 bean 默认都是单例的。</p>
</li>
<li><p>  prototype：每次请求都会创建一个新的 bean 实例。</p>
</li>
<li><p>  request：每一次 HTTP 请求都会产生一个新的 bean，该 bean 仅在当前 HTTP request 内有效。</p>
</li>
<li><p>  session：每一次 HTTP 请求都会产生一个新的 bean，该 bean 仅在当前 HTTP session 内有效。</p>
</li>
</ul>
<h3 id="3-HTTP请求"><a href="#3-HTTP请求" class="headerlink" title="3. HTTP请求"></a>3. HTTP请求</h3><p>下面这些注解对应 Http 常见的请求方式，用于标注接口路径请求。</p>
<h4 id="GetMapping"><a href="#GetMapping" class="headerlink" title="@GetMapping"></a><code>@GetMapping</code></h4><p>等价于 @RequestMapping(value=”/test”,method=RequestMethod.GET)</p>
<h4 id="PostMapping"><a href="#PostMapping" class="headerlink" title="@PostMapping"></a><code>@PostMapping</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;User&gt; <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Valid</span> User user)</span> &#123;</span><br><span class="line">    userService.save(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(HttpStatus.OK);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="PutMapping"><a href="#PutMapping" class="headerlink" title="@PutMapping"></a><code>@PutMapping</code></h4><p>put 方式的请求，常用语更新服务器上的资源。举个例子：<code>PUT /users/7</code>（更新编号为 7 的学生）</p>
<h4 id="DeleteMapping"><a href="#DeleteMapping" class="headerlink" title="@DeleteMapping"></a><code>@DeleteMapping</code></h4><p>DELETE 请求，从服务器删除特定的资源。</p>
<h3 id="4-前后端参数传递"><a href="#4-前后端参数传递" class="headerlink" title="4. 前后端参数传递"></a>4. 前后端参数传递</h3><h4 id="RequestParam-和-PathVariable"><a href="#RequestParam-和-PathVariable" class="headerlink" title="@RequestParam 和 @PathVariable"></a><code>@RequestParam</code> 和 <code>@PathVariable</code></h4><p>@RequestParam 用在方法的参数前面，获取请求中表单类型的key=value格式的数据。</p>
<p>@PathVariable 用于获取请求路径中的参数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;List&lt;User&gt;&gt; <span class="title function_">getUser</span><span class="params">(<span class="meta">@PathVariable</span> <span class="type">long</span> id,<span class="meta">@RequestParam</span> String macAddress)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(userService.findById(id),HttpStatus.OK);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a><code>@RequestBody</code></h4><p>获取请求 body 中的数据，常用于搭配 @PostMapping 请求来提交对象数据.  请求体 的<strong>Content-Type 必须为 application/json</strong> 格式的数据，接收到数据之后会自动将数据绑定到 Java 对象上去。</p>
<p>系统会使用 HttpMessageConverter 或者自定义的 HttpMessageConverter将请求的 body 中的 json 字符串转换为 java 对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;User&gt; <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Valid</span> User user)</span> &#123;</span><br><span class="line">    userService.save(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(HttpStatus.OK);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>强调一下： <strong>请求方法只可以有一个<code>@RequestBody</code>，但是可以有多个 <code>@RequestParam</code> 和 <code>@PathVariable</code></strong> 。 如果你的方法必须要用两个 <code>@RequestBody</code> 来接受数据的话，那你就只思考下你的设计了，或者套娃形式的。</p>
<h4 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a><code>@ResponseBody</code></h4><p>表示该方法的返回结果直接写入 HTTP response body 中，格式为 json。上面我们提到的 <strong>@RestController 其实就是 @Controller 和 @ResponseBody 两个结合起来的</strong>。</p>
<h3 id="5-读取配置"><a href="#5-读取配置" class="headerlink" title="5. 读取配置"></a>5. 读取配置</h3><h4 id="value"><a href="#value" class="headerlink" title="@value"></a><code>@value</code></h4><p>可以在任意 Spring 管理的 Bean 中通过这个注解获取任何来源配置的属性值。比如我们的 application.properties 或者 application.yml 配置文件中配置的属性值，当然也可以是 JVM 属性配置或者系统环境变量配置的值，如果对 Spring Boot 应用程序都有哪些属性配置源以及它们之间的优先级不了解的小伙伴可以看我之前的文章：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/UWT2nvI9VdEs8v0-eRkYGQ">Spring Boot 属性配置你所不知道的细节</a>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;who&#125;&quot;)</span></span><br><span class="line">String name;</span><br></pre></td></tr></table></figure>

<h4 id="ConfigurationProperties-重点"><a href="#ConfigurationProperties-重点" class="headerlink" title="@ConfigurationProperties(重点)"></a><code>@ConfigurationProperties</code>(重点)</h4><p>上面 @Value 在每个类中获取属性配置值的做法其实是不推荐的，我们一般在企业项目开发中，不会使用那么杂乱无章的写法而且维护也麻烦，通过就是一次性读取到一个 Java 配置类，然后需要使用的地方直接引用这个类就可以多次访问了，方便维护。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;my&quot;, ignoreUnknownFields = false)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyProperties</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Book&gt; books;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Book</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">private</span> String bookName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="PropertySource"><a href="#PropertySource" class="headerlink" title="@PropertySource"></a><code>@PropertySource</code></h4><p>这个注解是用来指定读取我们自定义的配置文件的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix= &quot;my&quot; )</span></span><br><span class="line"><span class="meta">@PropertySource(value = &#123;&quot;classpath:my.properties&quot;&#125;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> maxValue= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-参数校验"><a href="#6-参数校验" class="headerlink" title="6. 参数校验"></a>6. 参数校验</h3><p><strong>数据的校验的重要性就不用说了，即使在前端对数据进行校验的情况下，我们还是要对传入后端的数据再进行一遍校验，避免用户绕过浏览器直接通过一些 HTTP 工具直接向后端请求一些违法数据。</strong></p>
<p><strong>JSR(Java Specification Requests）</strong> 是一套 JavaBean 参数校验的标准，它定义了很多常用的校验注解，我们可以直接将这些注解加在我们 JavaBean 的属性上面，这样就可以在需要校验的时候进行校验了，非常方便！</p>
<p>校验的时候我们实际用的是 <strong>Hibernate Validator</strong> 框架。Hibernate Validator 是 Hibernate 团队最初的数据校验框架，Hibernate Validator 4.x 是 Bean Validation 1.0（JSR 303）的参考实现，Hibernate Validator 5.x 是 Bean Validation 1.1（JSR 349）的参考实现，目前最新版的 Hibernate Validator 6.x 是 Bean Validation 2.0（JSR 380）的参考实现。</p>
<p>需要注意的是从 Spring Boot 2.3开始，我们还需要显式地添加 spring-boot-starter-validation 依赖项，在此之前的 Spring Boot 版本是在 spring-boot-starter-web 依赖项中包含的不需要额外引入。</p>
<p>我现在使用的是 Spring Boot 2.5.2 版本了，所以手动增加依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>👉 需要注意的是： <strong>所有的注解，推荐使用 JSR 注解，即 <code>javax.validation.constraints</code>，而不是 <code>org.hibernate.validator.constraints</code></strong></p>
<h4 id="Bean字段验证注解"><a href="#Bean字段验证注解" class="headerlink" title="Bean字段验证注解"></a>Bean字段验证注解</h4><ul>
<li><p>  <code>@NotEmpty</code> 被注释的字符串的不能为 null 也不能为空</p>
</li>
<li><p>  <code>@NotBlank</code> 被注释的字符串非 null，并且必须包含一个非空白字符</p>
</li>
<li><p>  <code>@Null</code> 被注释的元素必须为 null</p>
</li>
<li><p>  <code>@NotNull</code> 被注释的元素必须不为 null</p>
</li>
<li><p>  <code>@AssertTrue</code> 被注释的元素必须为 true</p>
</li>
<li><p>  <code>@AssertFalse</code> 被注释的元素必须为 false</p>
</li>
<li><p>  <code>@Pattern(regex=,flag=)</code>被注释的元素必须符合指定的正则表达式</p>
</li>
<li><p>  <code>@Email</code> 被注释的元素必须是 Email 格式。</p>
</li>
<li><p>  <code>@Min(value)</code>被注释的元素必须是一个数字，其值必须大于等于指定的最小值</p>
</li>
<li><p>  <code>@Max(value)</code>被注释的元素必须是一个数字，其值必须小于等于指定的最大值</p>
</li>
<li><p>  <code>@DecimalMin(value)</code>被注释的元素必须是一个数字，其值必须大于等于指定的最小值</p>
</li>
<li><p>  <code>@DecimalMax(value)</code> 被注释的元素必须是一个数字，其值必须小于等于指定的最大值</p>
</li>
<li><p>  <code>@Size(max=, min=)</code>被注释的元素的大小必须在指定的范围内</p>
</li>
<li><p>  <code>@Digits (integer, fraction)</code>被注释的元素必须是一个数字，其值必须在可接受的范围内</p>
</li>
<li><p>  <code>@Past</code>被注释的元素必须是一个过去的日期</p>
</li>
<li><p>  <code>@Future</code> 被注释的元素必须是一个将来的日期</p>
</li>
</ul>
<h4 id="验证请求体-RequestBody"><a href="#验证请求体-RequestBody" class="headerlink" title="验证请求体(RequestBody)"></a>验证请求体(RequestBody)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(100)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;name 不能为空&quot;)</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="meta">@JsonProperty(value = &quot;name&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只需要在请求处理方法中需要验证的参数前加上 <code>@Valid</code> 注解就会开启校验了，如果验证失败将抛出异常：<code>MethodArgumentNotValidException</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;User&gt; <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Valid</span> User user)</span> &#123;</span><br><span class="line">    userService.save(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(HttpStatus.OK);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Validated"><a href="#Validated" class="headerlink" title="@Validated"></a>@Validated</h4><p>如果你的入参不是用一个 Java 对象来接收的话，比如用 @PathVariables 和 @RequestParam 注解来获取入参，这种情况下要校验参数不要忘记在类的头上加 @Validated 注解，<strong>这个参数可以告诉 Spring 去校验方法参数。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">   <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;List&lt;User&gt;&gt; <span class="title function_">findById</span><span class="params">( <span class="meta">@PathVariable</span> <span class="meta">@Max(value = 5,message = &quot;超过 id 的范围了&quot;)</span> <span class="type">long</span> id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(userService.findById(id),HttpStatus.OK);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-统一异常处理"><a href="#7-统一异常处理" class="headerlink" title="7. 统一异常处理"></a>7. 统一异常处理</h3><blockquote>
<p>异常处理通常也是我们在开发中一定要做的，因为不可能将一些程序员才能看懂的异常抛出到前端去（总会有不靠谱的同事忘记捕获异常的），所以一般都会加上统一的异常处理，在对用户不友好的错误堆栈转换为普通用户可以看懂的文案提示。</p>
</blockquote>
<p>这里涉及到的注解只有两个：</p>
<ol>
<li><p> <code>@ControllerAdvice</code> : 定义全局异常处理类，包含 @Component 所以可以被 Spring 扫描到。</p>
</li>
<li><p> <code>@ExceptionHandler</code> : 声明异常处理方法，表示遇到这个异常，就执行标注的方法。</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GlobalDefaultExceptionHandler</span> &#123;</span><br><span class="line">  <span class="comment">// 如果是遇到注解中指定的异常就会进这个方法处理后返回</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(&#123;MethodArgumentNotValidException.class, ConstraintViolationException.class&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> Map <span class="title function_">argumentErrorHandler</span><span class="params">(HttpServletRequest req, Exception e)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;参数不合法&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;param&quot;</span>, req.getParameterMap());</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-JPA数据持久化"><a href="#8-JPA数据持久化" class="headerlink" title="8. JPA数据持久化"></a>8. JPA数据持久化</h3><p>上面是百度百科给的概念，只能说在实际项目开发中还是用的不多，大家还是喜欢用 Mybatis，不过相比更加简洁的技术还是要学习下的。</p>
<h4 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h4><ul>
<li><p>  <code>@Entity</code></p>
</li>
<li><p>  <code>@Table</code></p>
</li>
</ul>
<p>这俩是放在 Java Bean 上面用来标注数据库实体对象和表明之间的映射关系的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span></span><br><span class="line">    <span class="meta">@JsonProperty(value = &quot;id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>

<h4 id="创建主键"><a href="#创建主键" class="headerlink" title="创建主键"></a>创建主键</h4><ul>
<li><p>  <code>@Id</code></p>
</li>
<li><p>  <code>@GeneratedValue</code></p>
</li>
</ul>
<p>这俩主键放在 Bean 的字段上，用来标识数据库的主键以及主键自动生成的。<strong>通过 <code>@GeneratedValue</code>直接使用 JPA 内置提供的四种主键生成策略来指定。</strong></p>
<ul>
<li><p>  <code>GenerationType.TABLE</code> 持久化引擎通过关系数据库的一张特定的表格来生成主键；</p>
</li>
<li><p>  <code>GenerationType.SEQUENCE</code> 随机序列；</p>
</li>
<li><p>  <code>GenerationType.IDENTITY</code> 主键自增长；</p>
</li>
<li><p>  <code>GenerationType.AUTO</code> 持久化引擎会根据数据库在以上三种主键生成策略中选择，默认选择的就是这个策略；</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>

<h4 id="设置字段类型"><a href="#设置字段类型" class="headerlink" title="设置字段类型"></a>设置字段类型</h4><p><code>@Column</code> 声明字段。</p>
<p>比如：Java Bean 属性名为 nickName 对应的数据库字段名为 user_name，长度为 32，非空。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column(name = &quot;user_name&quot;, nullable = false, length=32)</span></span><br><span class="line"><span class="keyword">private</span> String nickName;</span><br></pre></td></tr></table></figure>

<p>设置字段类型并且加默认值，这个还是挺常用的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Column(columnDefinition = <span class="string">&quot;tinyint(1) default 1&quot;</span>)</span><br><span class="line"><span class="keyword">private</span> Boolean enabled;</span><br></pre></td></tr></table></figure>

<h4 id="指定不持久化特定字段"><a href="#指定不持久化特定字段" class="headerlink" title="指定不持久化特定字段"></a>指定不持久化特定字段</h4><p><code>@Transient</code> ：有一些字段我们有时间不需要落库，就可以加上这个注解就好了。</p>
<h4 id="声明事务"><a href="#声明事务" class="headerlink" title="@声明事务"></a>@声明事务</h4><p>这个注解可以作用于类上，也可以作用于方法上。前者表示所有该类的 public 方法都配置相同的事务属性信息，后者表示当类配置了@Transactional，方法也配置了@Transactional，方法的事务会覆盖类的事务配置信息。</p>
<p>Exception 分为运行时异常 RuntimeException 和非运行时异常。在 <code>@Transactional</code> 注解中如果不配置 rollbackFor 属性,那么事物只会在遇到 RuntimeException 的时候才会回滚,加上 <code>rollbackFor=Exception.class</code> ,可以让事物在遇到非运行时异常时也回滚。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-JSON格式处理"><a href="#9-JSON格式处理" class="headerlink" title="9. JSON格式处理"></a>9. JSON格式处理</h3><h4 id="指定过滤字段"><a href="#指定过滤字段" class="headerlink" title="指定过滤字段"></a>指定过滤字段</h4><ul>
<li><p>  <code>@JsonIgnoreProperties</code> 作用在类上用于过滤掉特定字段不返回或者不解析。</p>
</li>
<li><p>  <strong><code>@JsonIgnore</code>一般用于类的属性上，作用和上面的<code>@JsonIgnoreProperties</code> 一样。</strong></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成json时将userRoles属性过滤</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties(&#123;&quot;password&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String fullName;</span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="格式化-json-数据"><a href="#格式化-json-数据" class="headerlink" title="格式化 json 数据"></a>格式化 json 数据</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern=&quot;yyyy-MM-dd HH:mm:ss&quot;,timezone=&quot;GMT+8&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Date createDate;</span><br></pre></td></tr></table></figure>

<p>要注意的是，它只会在类似 @ResponseBody 返回 json 数据的时候，才会返回格式化的 <code>yyyy-MM-dd HH:mm:ss</code> 时间，你直接使用System.out.println()输出的话，仍然是类似 <code>Fri Dec 01 21:05:20 CST 2017</code> 这样的时间样式。</p>
<h4 id="扁平化对象"><a href="#扁平化对象" class="headerlink" title="扁平化对象"></a>扁平化对象</h4><p><code>@JsonUnwrapped</code>： 这个可能不太好说，大家直接看代码就懂了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line">  <span class="meta">@JsonUnwrapped</span></span><br><span class="line">  <span class="keyword">private</span> Location location;</span><br><span class="line">  <span class="meta">@JsonUnwrapped</span></span><br><span class="line">  <span class="keyword">private</span> PersonInfo personInfo;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Getter</span></span><br><span class="line">  <span class="meta">@Setter</span></span><br><span class="line">  <span class="meta">@ToString</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Location</span> &#123;</span><br><span class="line">     <span class="keyword">private</span> String provinceName;</span><br><span class="line">     <span class="keyword">private</span> String countyName;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Getter</span></span><br><span class="line">  <span class="meta">@Setter</span></span><br><span class="line">  <span class="meta">@ToString</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PersonInfo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String fullName;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>未扁平化之前：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;provinceName&quot;</span><span class="punctuation">:</span><span class="string">&quot;广东&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;countyName&quot;</span><span class="punctuation">:</span><span class="string">&quot;深圳&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;personInfo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sevenluo&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;fullName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;程序员七哥&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>使用 <code>@JsonUnwrapped</code> 扁平对象之后：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line">    <span class="meta">@JsonUnwrapped</span></span><br><span class="line">    <span class="keyword">private</span> Location location;</span><br><span class="line">    <span class="meta">@JsonUnwrapped</span></span><br><span class="line">    <span class="keyword">private</span> PersonInfo personInfo;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;provinceName&quot;</span><span class="punctuation">:</span><span class="string">&quot;广东&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;countyName&quot;</span><span class="punctuation">:</span><span class="string">&quot;深圳&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sevenluo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fullName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;程序员七哥&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="10-测试处理"><a href="#10-测试处理" class="headerlink" title="10. 测试处理"></a>10. 测试处理</h3><p><code>@ActiveProfiles</code>一般作用于测试类上， 用于声明生效的 Spring 配置文件。</p>
<p><code>@Test</code>声明一个方法为测试方法。</p>
<p><strong><code>@Transactional</code>被声明的测试方法执行后数据会被回滚，避免污染测试数据。</strong></p>
<p><code>@WithMockUser</code> Spring Security 提供的，用来模拟一个真实用户，并且可以赋予权限。</p>
<h3 id="11-配置启动"><a href="#11-配置启动" class="headerlink" title="11. 配置启动"></a>11. 配置启动</h3><p><code>@SpringBootApplication</code> : 等价于使用 @Configuration、@EnableAutoConfiguration、@ComponentScan  三个注解。</p>
<p><code>@Configuration</code>：声明是是一个 Java 形式的配置类，Spring Boot 提倡基于 Java 的配置，相当于你之前在 xml 中配置 bean；</p>
<p><code>@EnableAutoConfiguration</code>：类级别的注解，这个注解告诉 Spring Boot 根据添加的 jar 依赖猜测你想如何配置 Spring，也就是 Spring 实现自动配置的开关。</p>
<p><code>@ComponentScan</code>：标注哪些路径下的类需要被Spring扫描。</p>
<p><code>@Conditional</code>：Spring4 新提供的注解，通过 @Conditional 注解可以根据代码中设置的条件装载不同的 bean，也是SpringBoot实现自动配置的基石。</p>
<p>Spring Boot 源码中大量扩展了 @Condition 注解，用于实现智能的自动化配置，满足各种使用场景。下面我给大家列举下：</p>
<ul>
<li><p>  <strong>@ConditionalOnBean</strong> ：配置了某个特定的Bean时条件为真。</p>
</li>
<li><p>  <strong>@ConditionalOnMissingBean</strong> ：没有配置特定的Bean时条件为真。</p>
</li>
<li><p>  <strong>@ConditionalOnClass</strong>：Classpath里有指定的类时条件为真。</p>
</li>
<li><p>  <strong>@ConditionalOnMissingClass</strong>：Classpath里没有指定的类时条件为真。</p>
</li>
<li><p>  <strong>@ConditionalOnExpression</strong>：给定的SpEL表达式计算结果为true。</p>
</li>
<li><p>  <strong>@ConditionalOnJava</strong>：Java的版本匹配特定值或者一个范围值。</p>
</li>
<li><p>  <strong>@ConditionalOnJndi</strong>：参数中给定的 JNDI 位置必须存在一个，如果没有给参数，则要有 JNDI InitialContext。</p>
</li>
<li><p>  <strong>@ConditionalOnProperty</strong>：指定的配置属性要有一个明确的值。</p>
</li>
<li><p>  <strong>@ConditionalOnResource</strong>：Classpath里没有指定的资源。</p>
</li>
<li><p>  <strong>@ConditionalOnWebApplication</strong>：这是一个Web应用程序。</p>
</li>
<li><p>  <strong>@ConditionalOnNotWebApplication</strong>：这不是一个Web应用程序。</p>
</li>
</ul>
<p>那目前暂定就先总结这么多，虽然花了不少时间，但是难免有遗漏，七哥后续也会继续更新，也欢迎大家评论区指导和补充，谢谢啦。</p>
<blockquote>
<p>扩展阅读：<a target="_blank" rel="noopener" href="https://github.com/isevenluo/spring-road">Spring江湖路系列文章</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://moqiang02.github.io/2022/10/02/Springboot%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/" data-id="cla0v660t011mg0v161oc3w6q" data-title="Springboot常用注解" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/10/05/SpringBoot%E4%BD%BF%E7%94%A8-Async%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          SpringBoot使用@Async实现异步任务
        
      </div>
    </a>
  
  
    <a href="/2022/09/29/SpringBoot%E5%88%9B%E5%BB%BAmaven%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">SpringBoot创建maven多模块项目</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">255</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/apache/">apache</a><span class="category-list-count">27</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/github%E5%8D%9A%E5%AE%A2/">github博客</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/html-css/">html+css</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iis/">iis</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">80</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><span class="category-list-count">115</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kotlin/">kotlin</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">68</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/memcached/">memcached</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">72</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a><span class="category-list-count">41</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nodejs/">nodejs</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a><span class="category-list-count">185</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">44</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E5%AE%83/">其它</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a><span class="category-list-count">51</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">开源项目</a><span class="category-list-count">73</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/">生活随笔</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/">量化交易</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AndroidStudio/" style="font-size: 13.16px;">AndroidStudio</a> <a href="/tags/AndroidUI/" style="font-size: 20px;">AndroidUI</a> <a href="/tags/Android%E4%BA%8B%E4%BB%B6%E6%8B%A6%E6%88%AA/" style="font-size: 11.05px;">Android事件拦截</a> <a href="/tags/Android%E5%BC%80%E6%BA%90/" style="font-size: 16.84px;">Android开源</a> <a href="/tags/CI/" style="font-size: 15.26px;">CI</a> <a href="/tags/CURL/" style="font-size: 12.63px;">CURL</a> <a href="/tags/DEDE/" style="font-size: 17.89px;">DEDE</a> <a href="/tags/Docker/" style="font-size: 14.21px;">Docker</a> <a href="/tags/Flask/" style="font-size: 10.53px;">Flask</a> <a href="/tags/JavaSE/" style="font-size: 18.95px;">JavaSE</a> <a href="/tags/Laravel/" style="font-size: 16.84px;">Laravel</a> <a href="/tags/Maven/" style="font-size: 11.05px;">Maven</a> <a href="/tags/MybatisPlus/" style="font-size: 11.05px;">MybatisPlus</a> <a href="/tags/Puppeteer/" style="font-size: 14.74px;">Puppeteer</a> <a href="/tags/SVN/" style="font-size: 10px;">SVN</a> <a href="/tags/Selenium/" style="font-size: 11.58px;">Selenium</a> <a href="/tags/SpringBoot/" style="font-size: 19.47px;">SpringBoot</a> <a href="/tags/Thinkphp/" style="font-size: 10px;">Thinkphp</a> <a href="/tags/UEditor/" style="font-size: 11.58px;">UEditor</a> <a href="/tags/VMware/" style="font-size: 12.11px;">VMware</a> <a href="/tags/Vue/" style="font-size: 17.37px;">Vue</a> <a href="/tags/WebSocket/" style="font-size: 12.63px;">WebSocket</a> <a href="/tags/ecshop/" style="font-size: 14.21px;">ecshop</a> <a href="/tags/scrapy/" style="font-size: 13.68px;">scrapy</a> <a href="/tags/smarty/" style="font-size: 12.11px;">smarty</a> <a href="/tags/socket/" style="font-size: 14.21px;">socket</a> <a href="/tags/sphinx/" style="font-size: 11.58px;">sphinx</a> <a href="/tags/vagrant/" style="font-size: 12.11px;">vagrant</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 11.05px;">微服务</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93/" style="font-size: 15.26px;">数据传输</a> <a href="/tags/%E6%AD%A3%E5%88%99/" style="font-size: 11.58px;">正则</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 15.79px;">消息队列</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 18.42px;">爬虫</a> <a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 16.32px;">集群</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/04/20/Spring-boot-admin-%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E5%88%A9%E5%99%A8/">Spring boot admin 服务监控利器</a>
          </li>
        
          <li>
            <a href="/2023/04/16/%E6%8E%A8%E9%80%81%E4%BB%A3%E7%A0%81%E5%88%B0-GitHub-%E4%BB%93%E5%BA%93%E5%87%BA%E9%94%99%EF%BC%9AWARNING-REMOTE-HOST-IDENTIFICATION-HAS-CHANGED/">推送代码到 GitHub 仓库出错：WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!</a>
          </li>
        
          <li>
            <a href="/2023/04/16/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BD%BF%E7%94%A8%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8Ffinal%E9%97%AE%E9%A2%98/">lambda表达式使用局部变量final问题</a>
          </li>
        
          <li>
            <a href="/2023/02/24/Java%E6%96%B9%E6%B3%95%E4%BC%A0%E5%8F%82%E5%88%B0%E5%BA%95%E4%BC%A0%E6%89%80%E9%9C%80%E5%8F%82%E6%95%B0%E5%A5%BD%E8%BF%98%E6%98%AF%E4%BC%A0%E5%AE%9E%E4%BD%93%E5%A5%BD%EF%BC%9F/">Java方法传参到底传所需参数好还是传实体好？</a>
          </li>
        
          <li>
            <a href="/2023/02/09/Java8%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B8%AD%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/">Java8集合框架中的新方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 moqiang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>

<!-- rex -->

<script src="/js/toc.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>